<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Natasha Project-- ANALYSIS</title>
        <link rel="stylesheet" type="text/css" href="css/natasha_home.css" />
        <link rel="icon" type="image/jpeg" href="img/IMG-1339.jpeg" />
    </head>
    <body>
        <!--#include virtual="menu.xhtml" -->
        <div class="sidenav">
            <img src="img/IMG-1339.jpeg" height="160" width="160" alt="logo" />
        </div>
        <div class="main">
            <h2>Results and Analysis</h2>
            <!--#include virtual="ref-percentage.svg" -->
            <h3>Percentage of <em>War and Peace</em> References per Song</h3>
            <p>In order to answer our research question of how much of Great Comet draws from War
                and Peace, we calculated the percentage of lines of stanzas of each song that have a
                strong correlation with a passage from the novel, which you can observe for yourself
                more thoroughly in our text browse function.</p>

            <p>Immediately, there is a glaring outlier: 0% of the “Prologue” comes from the novel.
                This is actually very correct, as “Prologue” isn’t really part of the musical’s
                storyline. As any good prologue should do, it sets up the storyline by introducing
                the setting and characters, starting with the oft-repeated line “There’s a war going
                on out there somewhere / and Andrey isn’t here”. This is particularly necessary in
                Great Comet because it takes place in the middle of War and Peace, so the audience
                needs a crash course of the many characters that they would have already known had
                they read the novel thus far.</p>

            <p>There are two 100%s in this graph: “Pierre and Anatole” and “Natasha Very Ill”.
                Despite this large number, “Natasha Very Ill” isn’t actually all that significant,
                as it is a very short song with only a handful of lines. In a more advanced graph,
                we would have added an element of being able to see how lines a song actually had to
                put that into perspective.</p>

            <p>Even if there are such outliers, we are still able to draw some conclusions. Songs
                with a lot of dialogue (“Natasha and Anatole”, “Sonya and Natasha”, “Pierre and
                Anatole”) all have very high percentages. These songs are almost completely
                comprised of dialogue taken directly out of War and Peace, with little to no
                alteration. This makes sense, as textual dialogue transfers easily into an operatic
                musical format wherein the characters sing all of their lines instead of speaking
                them. Because of this, songs with lots of conflict between two people are more
                likely to have higher percentages (“Pierre and Anatole”, “Sonya and Natasha”, “In My
                House”). It makes sense that this would be the case, as highly charged emotion is
                better expressed through back and forth dialogue rather than flowery musical prose
                that a lyricist could take more artistic liberties with (see “Dust and Ashes”).</p>

            <p>“Dust and Ashes” is somewhat of an outlier, coming in at a low 11%. This is a unique
                case because this solo, sung by Pierre, is more of an expression of the themes of
                his character arc throughout the entire novel (being unhappy with life, etc) rather
                than a song that follows a specific part of the storyline. Because of this, there is
                a very small percentage of lines that come straight out of War and Peace, as the way
                this specific song draws from the novel is more thematic than directly lyrical. This
                allowed for a lot more artistic liberty in the lyrics, and they sure did; it’s a six
                minute or so song. The composer has been noted as saying something like “When you
                have Josh Groban, you gotta make him sing!”, and sing he did. As an aside, the lyric
                that comes from the novel is “They say we are asleep until we fall in love / we are
                children of dust and ashes”. This quote isn’t even said by Pierre, nor is it even
                part of the book of the novel that Great Comet takes from. It’s spoken by a minor
                character in one of the very first scenes of the novel, writing to his wife from the
                front lines of the war. The more you know!</p>

            <h3>Instances of Spoken Action per Character</h3>
            <!--#include virtual="spokenaction.svg" -->
            <p> This graph analyzes spoken action. Spoken action is when a character describes what
                they or another character are doing. This is a characteristic unique to Great Comet
                - other musicals don’t usually do that. Some examples include “Natasha’s whole body
                shook / with noiseless, convulsive sobs” (Sonya, “In My House”) and “I seize you by
                the collar with my big big hands” (Pierre, “Pierre and Anatole”). </p>

            <p> This graph analyzes two main things: when a character describes themselves (in the
                left column, divided into 1st (red) and 3rd (blue) person), and then when they
                describes another character (in the rightmost column; scroll over a color to see who
                it describes! Hooray for interactivity!). </p>

            <p> Many hypotheses that we had originally were proved to be true. Since Anatole is a
                very self-centered character, we thought that he would have very little instances of
                describing others if at all. This is correct, with him talking about another
                character only once as opposed to many instances of him talking about his favorite
                subject: himself. </p>

            <p> We guessed that Natasha and Pierre, being the titular characters of the musical,
                would be high in scale of spoken action given the fact that they talk a lot. This
                was generally true, with them being some of the highest contenders on this graph.
                Natasha scores particularly high on the describing herself scale, which could
                perhaps be attributed to her childishness: she has to explain everything, or else
                she won’t understand it. She describes Anatole’s action the most out of anyone,
                which makes sense, as her interactions with him are confusing to her, leading to a
                lot of spoken action as she tries to make sense of what is happening to her. </p>

            <p> Sonya, dear Sonya, is exactly what we expected. Sonya is a very meek, shy, and
                selfless character, so we hypothesized that she would describe others more than she
                would describe herself. We guessed that she would describe Natasha the most, as she
                cares very deeply for her adoptive cousin, and we were right. In fact, Sonya is the
                first person to ever describe spoken action in “Moscow”, describing Natasha. What’s
                curious is that Sonya was the one chosen to be a narrator of sorts for the opera
                scene in “The Opera”. It could be because Sonya is a good candidate for the role
                because of her observant character traits, seen in the way she describes action the
                most out of anyone else. A more practical (and less based in data) answer could be
                because the composer wanted to give the actress more lines, and since Sonya’s
                actress is phenomenal, none of us are complaining. </p>

            <p> Other clusters of characters make sense in the context of the musical. The musical
                portrays Dolokhov and Hélène as Anatole’s cronies, which makes their describing
                Anatole perfectly logical. Bolkonsky is a little senile and self-obsessed, which
                gives credibility to the idea of him only describing himself, especially in the
                third person. Mary is his caretaker, so it makes sense that she would describe him
                often. The servant is, as indicated, a very minor character who only serves others,
                so it makes sense that they would only ever describe other people. </p>
            
            <h3>Comparing the Percentage of Character References between <em>War and Peace</em> and “Natasha, Pierre, and The Great Comet of 1812”</h3>
            <!--#include virtual="chara_ref_comparison.svg" -->
		<div id="comparison_graph">
			<svg xmlns="https://www.w3.org/2000/svg" height="500">
				<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:comet="http://natasha.obdurodon.org/" xmlns:xs="http://www.w3.org/2001/XMLSchema"
  exclude-result-prefixes="#all" version="3.0" xmlns="http://www.w3.org/2000/svg"
  xmlns:map="http://www.w3.org/2005/xpath-functions/map">
  <!-- ================================================================================================ -->
  <xsl:output method="xml" indent="yes"/>
  <!-- ================================================================================================ -->
  <!-- Stylesheet variables                                                                             -->
  <!-- ================================================================================================ -->
  <xsl:variable name="book8" as="document-node()"
    select="document('../XML/War-And-Peace_Book-Eight.xml')"/>
  <xsl:variable name="allSongs" as="document-node()+"
    select="collection('../XML/xml_lyrics?match=\d.*\.xml')"/>
  <xsl:variable name="novel-characters-count" as="xs:integer" select="count($book8//chara)"/>
  <xsl:variable name="song-characters-count" as="xs:integer" select="count($allSongs//chara)"/>
  <!-- ================================================================================================ -->
  <!-- Maps are used to draw from different files to appear in the same output                          -->
  <!-- ================================================================================================ -->
  <xsl:variable name="novel-characters" as="map(*)">
    <xsl:map>
      <xsl:for-each-group select="$book8//chara/@ref" group-by=".">
        <xsl:map-entry key="current-grouping-key()">
          <xsl:value-of select="count(current-group())"/>
        </xsl:map-entry>
      </xsl:for-each-group>
    </xsl:map>
  </xsl:variable>
  <xsl:variable name="song-characters" as="map(*)">
    <xsl:map>
      <xsl:for-each-group select="$allSongs//chara/@ref" group-by=".">
        <xsl:map-entry key="current-grouping-key()">
          <xsl:value-of select="count(current-group())"/>
        </xsl:map-entry>
      </xsl:for-each-group>
    </xsl:map>
  </xsl:variable>
  <xsl:variable name="maxCount" as="xs:integer" select="
      map:for-each(map:merge(($novel-characters, $song-characters)), function ($k, $v) {
        $v
      }) => max()"/>
  <!-- ================================================================================================ -->
  <!-- More stylesheet variables: the ones that affect the graph physicalities                          -->
  <!-- ================================================================================================ -->
  <xsl:variable name="barWidth" as="xs:double" select="30"/>
  <xsl:variable name="barSpacing" as="xs:double" select="$barWidth div 2"/>
  <xsl:variable name="totalBarWidth" as="xs:double" select="$barWidth + $barSpacing"/>
  <xsl:variable name="yScale" as="xs:double" select="5"/>
  <xsl:variable name="maxHeight" as="xs:double" select="100 * $yScale"/>
  <xsl:variable name="maxWidth" as="xs:double"
    select="($barWidth + $totalBarWidth) * count(map:keys($novel-characters))"/>
  <!-- ================================================================================================ -->
  <!-- User-defined functions                                                                           -->
  <!-- ================================================================================================ -->
  <xsl:function name="comet:titleCase" as="xs:string">
    <!-- ================================================================================================ -->
    <!-- Capitalize first letter of each word in phrase                                                   -->
    <!--                                                                                                  -->
    <!-- Parameter:                                                                                       -->
    <!--   $input as xs:string : phrase to be initial-capitalized                                         -->
    <!--                                                                                                  -->
    <!-- Result: xs:string                                                                                -->
    <!-- ================================================================================================ -->
    <xsl:param name="input" as="xs:string"/>
    <xsl:value-of select="
        tokenize($input)
        ! (substring(., 1, 1) ! upper-case(.) || lower-case(substring(., 2)))"/>
  </xsl:function>
  <xsl:function name="comet:round-up-to-integer" as="xs:integer">
    <!-- ================================================================================================ -->
    <!-- Round double up to closest multiple of specified integer                                         -->
    <!--                                                                                                  -->
    <!-- Parameters:                                                                                      -->
    <!--   $input as xs:double : value to be rounded up                                                   -->
    <!--   $rounding-target as xs:integer : integer for multiple target                                   -->
    <!--                                                                                                  -->
    <!-- Result: xs:integer                                                                               -->
    <!--                                                                                                  -->
    <!-- If input is already integer multiple of rounding target, return                                  -->
    <!-- Else integer division finds greatest lower multiple, add                                         -->
    <!--   rounding-target to bring to lowest higher multiple                                             -->
    <!-- ================================================================================================ -->
    <xsl:param name="input" as="xs:double"/>
    <xsl:param name="rounding-target" as="xs:integer"/>
    <xsl:sequence select="
        if ($input mod $rounding-target eq 0) then
          $input cast as xs:integer
        else
          $input idiv $rounding-target * $rounding-target + $rounding-target"/>
  </xsl:function>
  <!-- ================================================================================================ -->
  <!-- Templates                                                                                        -->
  <!-- ================================================================================================ -->
  <xsl:template name="xsl:initial-template">
    <svg viewBox="-150 -{$maxHeight + 25} {$maxWidth + 300} {$maxHeight + 300}" width="100%"
      style="background-color:#FED69A;">
      <!-- ================================================================================================ -->
      <!-- Horizontal ruling lines, tick marks, labels                                                      -->
      <!-- ================================================================================================ -->
      <xsl:variable name="max-song-pct" as="xs:double"
        select="$song-characters?* => max() div $song-characters-count * 100"/>
      <xsl:variable name="y-ruling-max" as="xs:integer"
        select="comet:round-up-to-integer($max-song-pct, 3)"/>
      <xsl:variable name="y-ruling-range" as="xs:integer+"
        select="(0 to $y-ruling-max)[. mod 3 eq 0]"/>
      <xsl:for-each select="$y-ruling-range">
        <xsl:variable name="yPos" as="xs:double" select=". * 10"/>
        <line x1="0" y1="-{$yPos}" x2="{$maxWidth + $barSpacing}" y2="-{$yPos}" stroke="silver"
          stroke-width="1"/>
        <text x="-5" y="-{$yPos}" text-anchor="end" dominant-baseline="central" font-size="smaller">
          <xsl:value-of select="."/>
        </text>
      </xsl:for-each>
      <!-- ================================================================================================ -->
      <!-- Bars and bar labels (names, percentages)                                                         -->
      <!-- ================================================================================================ -->
      <xsl:for-each select="map:keys($novel-characters)">
        <xsl:sort/>
        <!-- ================================================================================================ -->
        <!-- Local variables                                                                                  -->
        <!-- ================================================================================================ -->
        <xsl:variable name="xPos-Songs" as="xs:double"
          select="$barSpacing + (position() - 1) * (2 * $barWidth + $barSpacing)"/>
        <xsl:variable name="yPos-Songs" as="xs:double"
          select="$song-characters(.) div $song-characters-count * 100 * 10"/>
        <xsl:variable name="xPos-Book" as="xs:double" select="$xPos-Songs + $barWidth"/>
        <xsl:variable name="yPos-Book" as="xs:double"
          select="$novel-characters(.) div $novel-characters-count * 100 * 10"/>
        <!-- ================================================================================================ -->
        <!-- Plot bars and bar names                                                                          -->
        <!-- ================================================================================================ -->
        <rect x="{$xPos-Songs}" y="-{$yPos-Songs}" width="{$barWidth}" height="{$yPos-Songs}"
          fill="navy"/>
        <text x="{$xPos-Book}" y="10" writing-mode="tb">
          <xsl:value-of select="comet:titleCase(.)"/>
        </text>
        <rect x="{$xPos-Book}" y="-{$yPos-Book}" width="{$barWidth}" height="{$yPos-Book}"
          fill="crimson"/>
        <!-- ================================================================================================ -->
        <!-- Plot bar percentage labels                                                                       -->
        <!-- ================================================================================================ -->
        <xsl:variable name="novel-chara-percent" as="xs:double"
          select="100 * $novel-characters(.) div $novel-characters-count"/>
        <text x="{$xPos-Book + ($barWidth div 2)}" y="-{$yPos-Book + 5}" text-anchor="middle"
          font-size="12">
          <xsl:value-of select="(round($novel-chara-percent, 2))"/>% </text>

        <xsl:variable name="song-chara-percent" as="xs:double"
          select="100 * $song-characters(.) div $song-characters-count"/>
        <text x="{$xPos-Songs + ($barWidth div 2)}" y="-{$yPos-Songs + 5}" text-anchor="middle"
          font-size="12">
          <xsl:value-of select="(round($song-chara-percent, 2))"/>% </text>
      </xsl:for-each>
      <!-- ================================================================================================ -->
      <!-- Axes                                                                                             -->
      <!-- ================================================================================================ -->
      <line x1="0" y1="0" x2="{$maxWidth + $barSpacing}" y2="0" stroke="black"
        stroke-linecap="square"/>
      <line x1="0" y1="0" x2="0" y2="-{$maxHeight - 200}" stroke="black" stroke-linecap="square"/>
      <!-- ================================================================================================ -->
      <!-- Chart Labels                                                                                     -->
      <!-- ================================================================================================ -->
      <text x="{$maxWidth div 2}" y="{$yScale * 30}" text-anchor="middle" font-size="large"
        >Characters</text>
      <text x="-80" y="-{$maxHeight div 2 + 35}" writing-mode="tb" font-size="large">
        <tspan>Frequency of Character</tspan>
      </text>
      <text x="-110" y="-{$maxHeight div 2 + 45}" writing-mode="tb" font-size="large">
        <tspan>References by Percentage</tspan>
      </text>
      <!-- ================================================================================================ -->
      <!-- Key                                                                                              -->
      <!-- ================================================================================================ -->
      <text x="{$maxWidth div 2}" y="{$yScale * -70}" text-anchor="middle" font-size="large"
        >Comparing the Percentage of Character References between Novel and Musical</text>
      <rect x="{$maxWidth + 50}" y="{$yScale * -40}" width="300" height="100" fill="white"/>
      <text x="{$maxWidth + 60}" y="-{$yScale * 34}" font-size="large">
        <tspan>Key:</tspan>
      </text>
      <text x="{$maxWidth + 90}" y="-{$yScale * 28}" font-size="small">
        <tspan>“The Great Comet”</tspan>
      </text>
      <text x="{$maxWidth + 90}" y="-{$yScale * 23}" font-size="small" font-style="italic">
        <tspan>War and Peace</tspan>
      </text>
      <rect x="{$maxWidth + 60}" y="-{$yScale * 26}" width="15" height="15" fill="crimson"/>
      <rect x="{$maxWidth + 60}" y="-{$yScale * 31}" width="15" height="15" fill="navy"/>
    </svg>
  </xsl:template>
</xsl:stylesheet>
			</svg>
			</div>
		<p> Using the completed markup of both War and Peace and "Natasha, Pierre, and the Great Comet of 1812", we were able to further our comparative research of the novel (book eight, specifically) and the musical. This graph represents the percentage of character references (excluding pronouns) in both works. As far as can be presumed by the data collected, both the novel and the musical put similar emphasis on the main characters in each story. This research assists the theory that book eight of War and Peace and "The Great Comet of 1812" follows a similar plot. </p>
			
		<p> The most glaring observation that can be made from this chart is how often Natasha and Pierre are referenced in the musical compared to the book. While the book seems to more evenly spread out the importance of each character, the musical more heavily focuses on Natasha and Pierre. Hence the official name of the musical “Natasha (our most significant character), Pierre (our second most significant character), and The Great Comet (not currently established as character role)”. </p>
			
		<p> Anatole stands out as well as a significant character in the musical. Anatole and Pierre are referenced evenly, but when looking at the novel, we can see that Anatole is referenced much more than Pierre. This could be interpreted as Anatole taking on a larger role in the musical, Pierre having a smaller role in the book, or both. This question could have a more precise answer, should the research have focused on pronouns and all spoken actions (not just when referenced by name) (see limitations). </p>
			
		<p> As seen in the key, the blue bars represent the musical and the red bars represent the book. At first glance, most blue bars appear to be taller than their book counterpart, the red bars. This applies to nearly all the characters, save for one. Balaga is the only character who appears more often in the book than in the musical. This can be attributed to Balaga not being often referenced in the musical, save for the first song where he is introduced. “Balaga’s just for fun!” implies that his character carries no true weight to the musical and is just for comedic value. In the novel, Balaga’s character carries more depth and contributes more to the plot of the story. </p>
			
		<p> LIMITATIONS: We do acknowledge that there are limitations to our findings. First, since we did not include pronouns in the conduction of our markup in either the book or the musical, this cannot lead to a 100% accurate display of the data. Second, this data does not display characters that might have been in a scene or spoken to directly without the mention of their name. Instances of this occur in the book and the musical, but based on the markup we conducted, we would have no way of knowing when this could take place. </p>
			
            <h3>Conclusions</h3>
            <p>The amount of lyrics that come directly from the text of War and Peace varies between
                each song, and depends on what is going on in the song. Songs with more dialogue are
                more likely to be more text-based, whereas more thematic songs are more likely to
                place lower on the spectrum of percentages. It’s very clear that War and Peace was
                drawn on heavily for this musical, which makes Great Comet very unique in adaptation
                and in the general scope of what musical theatre can be. While the instances of
                spoken action were more rare than we expected, who describes others and who they
                describe speaks volumes about the kind of character they are and the role they play
                in the overall story.</p>
        </div>
    </body>
</html>
